<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentasi Atom Magnesium - Kelompok 4</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2c3e50);
            color: white;
            overflow: hidden;
            height: 100vh;
            position: relative;
            touch-action: none;
        }
        
        #canvas-container {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .header {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 12px 20px;
            border-radius: 12px;
            z-index: 20;
            max-width: 95%;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        }
        
        .header h1 {
            margin: 0;
            font-size: 1.4rem;
            color: #3498db;
            margin-bottom: 4px;
            font-weight: 600;
        }
        
        .header p {
            margin: 0;
            font-size: 0.9rem;
            color: #ecf0f1;
            font-weight: 500;
        }
        
        #info-panel {
            position: absolute;
            bottom: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            max-width: 95%;
            z-index: 10;
            width: 300px;
        }
        
        /* Kontrol utama di kanan atas */
        #main-controls {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: flex-end;
            max-width: 95%;
        }
        
        #atom-controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            text-align: center;
        }
        
        #audio-controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            width: 200px;
        }
        
        .audio-top-row {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        #subtitle {
            position: absolute;
            bottom: 90px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            width: 90%;
            max-width: 900px;
            text-align: center;
            font-size: 1.1rem;
            z-index: 10;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            display: none;
            line-height: 1.6;
            font-weight: 500;
        }
        
        button {
            padding: 8px 12px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            min-width: 120px;
        }
        
        button:hover {
            background: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.25);
        }
        
        button:active {
            transform: translateY(1px);
            background: #2980b9;
        }
        
        .audio-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1rem;
            min-width: auto;
        }
        
        h2 {
            color: #2c3e50;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
            margin-bottom: 12px;
            font-size: 1.2rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 8px;
        }
        
        td {
            padding: 6px 0;
            border-bottom: 1px solid #eee;
            font-size: 0.85rem;
        }
        
        td:first-child {
            font-weight: bold;
            color: #2c3e50;
            width: 40%;
        }
        
        .progress-container {
            position: absolute;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            height: 6px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            z-index: 10;
        }
        
        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            border-radius: 8px;
            transition: width 0.1s linear;
        }
        
        .highlight {
            color: #e74c3c;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(231, 76, 60, 0.3);
        }
        
        .atom-info {
            font-size: 0.8rem;
            margin-top: 12px;
            color: #2c3e50;
            line-height: 1.4;
        }
        
        .atom-info strong {
            color: #e74c3c;
        }
        
        #volume-control {
            width: 100%;
            margin-top: 5px;
        }
        
        .volume-label {
            color: #2c3e50;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .controls-label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        /* Responsiveness */
        @media (max-width: 768px) {
            .header {
                top: 10px;
                left: 10px;
                padding: 10px 15px;
            }
            
            .header h1 {
                font-size: 1.2rem;
            }
            
            .header p {
                font-size: 0.8rem;
            }
            
            #info-panel {
                position: relative;
                margin: 15px auto;
                width: 90%;
                max-width: none;
                bottom: auto;
                left: auto;
                top: auto;
            }
            
            #main-controls {
                position: relative;
                margin: 15px auto;
                width: 90%;
                max-width: none;
                top: auto;
                right: auto;
                align-items: center;
            }
            
            #subtitle {
                bottom: 120px;
                font-size: 1rem;
                padding: 10px 15px;
                width: 95%;
            }
            
            .progress-container {
                bottom: 170px;
                width: 85%;
            }
            
            button {
                padding: 7px 10px;
                font-size: 0.85rem;
                min-width: 100px;
            }
            
            .audio-btn {
                width: 35px;
                height: 35px;
            }
            
            #audio-controls {
                width: 90%;
            }
        }
        
        @media (max-width: 480px) {
            #main-controls {
                flex-direction: column;
                align-items: center;
            }
            
            #atom-controls, #audio-controls {
                width: 100%;
            }
        }
        
        /* Fullscreen mode */
        .fullscreen-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 30;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        /* Atom info styling */
        .atom-fact {
            background: rgba(52, 152, 219, 0.1);
            border-left: 4px solid #3498db;
            padding: 10px;
            margin-top: 10px;
            border-radius: 0 8px 8px 0;
        }
        
        .magnesium-model {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            z-index: 5;
            pointer-events: none;
        }
        
        .android-audio-fix {
            position: absolute;
            width: 0;
            height: 0;
            overflow: hidden;
            opacity: 0;
        }
        
        .publish-guide {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            z-index: 25;
            max-width: 300px;
            font-size: 0.8rem;
            display: none;
        }
        
        .publish-guide h3 {
            margin-bottom: 8px;
            color: #3498db;
        }
        
        .publish-guide-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 25;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <button class="fullscreen-btn" id="fullscreenBtn">⛶</button>
    <button class="publish-guide-btn" id="publishGuideBtn">?</button>
    
    <div id="canvas-container"></div>
    
    <div class="header">
        <h1>Presentasi Atom Magnesium (Mg-12)</h1>
        <p>Kelompok 4: Riski, Nindi, Jasmine, Bima, Mirza</p>
    </div>
    
    <!-- Kontrol utama di kanan atas -->
    <div id="main-controls">
        <div id="atom-controls">
            <h2>Kontrol Atom</h2>
            <button id="playBtn">⏸️ Pause Atom</button>
            <button id="resetBtn">↻ Reset View</button>
        </div>
        
        <div id="audio-controls">
            <h2>Kontrol Audio</h2>
            <div class="audio-top-row">
                <button id="audioPlay" class="audio-btn">▶️</button>
                <button id="audioPause" class="audio-btn">⏸️</button>
                <button id="audioRestart" class="audio-btn">↺</button>
            </div>
            <div class="volume-label">Volume</div>
            <input type="range" id="volume-control" min="0" max="1" step="0.1" value="0.7">
        </div>
    </div>
    
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div id="subtitle"></div>
    
    <div id="info-panel">
        <h3>Informasi Atom Magnesium</h3>
        <table>
            <tr><td>Simbol</td><td><span class="highlight">Mg</span></td></tr>
            <tr><td>Nomor Atom</td><td><span class="highlight">12</span></td></tr>
            <tr><td>Massa Atom</td><td><span class="highlight">24.305 u</span></td></tr>
            <tr><td>Konfigurasi Elektron</td><td><span class="highlight">[Ne] 3s²</span></td></tr>
            <tr><td>Golongan</td><td><span class="highlight">Alkali Tanah (2)</span></td></tr>
            <tr><td>Elektron Valensi</td><td><span class="highlight">2</span></td></tr>
            <tr><td>Titik Leleh</td><td><span class="highlight">650°C</span></td></tr>
        </table>
        <div class="atom-info">
            <p>Magnesium adalah logam ringan putih keabu-abuan, dengan densitas dua pertiga dari aluminium. Magnesium memiliki titik leleh terendah di antara logam alkali tanah.</p>
            <div class="atom-fact">
                <strong>Fakta Menarik:</strong> Magnesium adalah logam paling melimpah ke-8 di kerak bumi!
            </div>
        </div>
    </div>
    
    <!-- Solusi audio untuk Android -->
    <div class="android-audio-fix">
        <audio id="androidAudio" controls></audio>
    </div>
    
    <div class="publish-guide" id="publishGuide">
        <h3>Cara Publikasi Website</h3>
        <p>1. Simpan file ini sebagai "index.html"</p>
        <p>2. Buat akun GitHub (gratis)</p>
        <p>3. Buat repository baru</p>
        <p>4. Upload file HTML ke repository</p>
        <p>5. Aktifkan GitHub Pages di pengaturan</p>
        <p>6. Website Anda akan live di: username.github.io/repo</p>
        <p><strong>Alternatif lain:</strong> Netlify, Vercel, Cloudflare Pages</p>
    </div>

    <script>
        // ================ SETUP SCENE ================
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a2a);
        
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;
        
        const renderer = new THREE.WebGLRenderer({ 
            antialias: true, 
            alpha: true,
            powerPreference: "high-performance"
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);
        
        // Orbit controls
        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.enableZoom = true;
        controls.enablePan = true;
        
        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.9);
        directionalLight.position.set(1, 1, 2);
        scene.add(directionalLight);
        
        // Point light for glow effect
        const pointLight = new THREE.PointLight(0x00ff88, 1.2, 50);
        pointLight.position.set(0, 0, 0);
        scene.add(pointLight);
        
        // Stars background
        const starsGeometry = new THREE.BufferGeometry();
        const starsMaterial = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 0.1,
            transparent: true,
            sizeAttenuation: true
        });
        
        const starsVertices = [];
        for (let i = 0; i < 800; i++) {
            const x = (Math.random() - 0.5) * 200;
            const y = (Math.random() - 0.5) * 200;
            const z = (Math.random() - 0.5) * 200;
            starsVertices.push(x, y, z);
        }
        
        starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starsVertices, 3));
        const stars = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(stars);

        // ================ ATOM MODEL ================
        // Nucleus (protons and neutrons)
        const nucleusGroup = new THREE.Group();
        const protonGeometry = new THREE.SphereGeometry(0.2, 24, 24);
        const neutronGeometry = new THREE.SphereGeometry(0.18, 24, 24);
        
        const protonMaterial = new THREE.MeshPhongMaterial({ 
            color: 0xff4444, 
            shininess: 100,
            emissive: 0xff0000,
            emissiveIntensity: 0.15
        });
        
        const neutronMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x4444ff, 
            shininess: 100,
            emissive: 0x0000ff,
            emissiveIntensity: 0.15
        });
        
        // Create 12 protons and 12 neutrons in random positions within nucleus
        for (let i = 0; i < 24; i++) {
            const radius = Math.random() * 0.4;
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(2 * Math.random() - 1);
            
            const x = radius * Math.sin(phi) * Math.cos(theta);
            const y = radius * Math.sin(phi) * Math.sin(theta);
            const z = radius * Math.cos(phi);
            
            if (i < 12) { // Protons
                const proton = new THREE.Mesh(protonGeometry, protonMaterial);
                proton.position.set(x, y, z);
                nucleusGroup.add(proton);
            } else { // Neutrons
                const neutron = new THREE.Mesh(neutronGeometry, neutronMaterial);
                neutron.position.set(x, y, z);
                nucleusGroup.add(neutron);
            }
        }
        scene.add(nucleusGroup);
        
        // Electron shells - all electrons are green
        const shellRadii = [1.2, 2.0, 2.8];
        const electronCounts = [2, 8, 2];
        
        const electronGeometry = new THREE.SphereGeometry(0.1, 16, 16);
        const electrons = [];
        
        // Create electron shells
        for (let shellIdx = 0; shellIdx < 3; shellIdx++) {
            const radius = shellRadii[shellIdx];
            const count = electronCounts[shellIdx];
            
            // Create orbital path (transparent ring)
            const orbitGeometry = new THREE.TorusGeometry(radius, 0.01, 12, 80);
            const orbitMaterial = new THREE.MeshBasicMaterial({ 
                color: 0x00ff88, 
                transparent: true, 
                opacity: 0.25 
            });
            const orbit = new THREE.Mesh(orbitGeometry, orbitMaterial);
            orbit.rotation.x = Math.PI / 2;
            scene.add(orbit);
            
            // Create electrons for this shell
            for (let i = 0; i < count; i++) {
                const angle = (i / count) * Math.PI * 2;
                const x = radius * Math.cos(angle);
                const y = radius * Math.sin(angle);
                
                const electronMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x00ff88,
                    emissive: 0x00ff88,
                    emissiveIntensity: 0.8
                });
                
                const electron = new THREE.Mesh(electronGeometry, electronMaterial);
                electron.position.set(x, y, 0);
                electron.userData = {
                    shellIdx: shellIdx,
                    angle: angle,
                    speed: 0.02 + shellIdx * 0.005,
                    radius: radius
                };
                
                scene.add(electron);
                electrons.push(electron);
            }
        }
        
        // ================ ANIMATION ================
        let isAnimating = true;
        
        function animateElectrons() {
            if (!isAnimating) return;
            
            electrons.forEach(electron => {
                const data = electron.userData;
                data.angle += data.speed;
                
                // Add some vertical movement for 3D effect
                const verticalOffset = Math.sin(data.angle * 2) * 0.3;
                
                electron.position.x = data.radius * Math.cos(data.angle);
                electron.position.y = data.radius * Math.sin(data.angle);
                electron.position.z = verticalOffset;
            });
        }
        
        // ================ CONTROLS ================
        document.getElementById('playBtn').addEventListener('click', function() {
            isAnimating = !isAnimating;
            this.textContent = isAnimating ? '⏸️ Pause Atom' : '▶️ Play Atom';
        });
        
        document.getElementById('resetBtn').addEventListener('click', function() {
            camera.position.set(0, 0, 5);
            camera.lookAt(0, 0, 0);
            controls.reset();
        });
        
        // Fullscreen control
        document.getElementById('fullscreenBtn').addEventListener('click', function() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                this.textContent = '⛶';
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    this.textContent = '⛶';
                }
            }
        });
        
        // Publish guide toggle
        document.getElementById('publishGuideBtn').addEventListener('click', function() {
            const guide = document.getElementById('publishGuide');
            guide.style.display = guide.style.display === 'block' ? 'none' : 'block';
        });
        
        // ================ AUDIO NARRATION ================
        const subtitleEl = document.getElementById('subtitle');
        const progressBar = document.getElementById('progressBar');
        const androidAudio = document.getElementById('androidAudio');
        
        // Narration script with timing and audio files
        const narrationScript = [
            { 
                time: 0, 
                text: "<b>Perkenalkan kami dari kelompok 4</b> yang beranggotakan <b>Riski, Nindi, Jasmine, Bima, Mirza</b>.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 4, 
                text: "Izinkan kami memulai presentasi kami, <b>atom</b> yang akan kami tampilkan adalah <b>atom magnesium</b> dengan jumlah <b>Proton 12, Neutron 12, dan Elektron 12</b>, seperti yang kalian bisa lihat pada proyeksi 3D di atas.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 8, 
                text: "Untuk <b>konfigurasi elektronnya</b> adalah <b>1s² 2s² 2p⁶ 3s²</b>.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 12, 
                text: "Untuk <b>informasi atom</b>: Unsur magnesium adalah <b>logam ringan putih keabu-abuan</b>, dengan densitas <b>dua pertiga dari densitas aluminium</b>. Ia menjadi sedikit kusam saat terpapar udara. Walaupun, tidak seperti logam alkali tanah lainnya, tidak perlu disimpan di lingkungan bebas oksigen, karena magnesium dilindungi oleh <b>lapisan tipis oksida</b> yang cukup kedap dan sulit dihilangkan.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 20, 
                text: "Magnesium memiliki <b>titik leleh terendah (650 °C)</b> dan <b>titik didih terendah</b> di antara semua logam alkali tanah.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 25, 
                text: "Biasanya, magnesium banyak digunakan sebagai:",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 27, 
                text: "<b>1. Logam pilihan dalam industri</b>: Magnesium ringan dan kuat, sehingga sering digunakan dalam pembuatan komponen otomotif dan pesawat terbang untuk mengurangi bobot dan meningkatkan efisiensi bahan bakar.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 35, 
                text: "<b>2. Paduan logam</b>: Magnesium sering dipadukan dengan aluminium untuk membuat bahan yang lebih ringan, tetapi tetap kuat, yang digunakan dalam industri konstruksi dan elektronik.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 42, 
                text: "<b>3. Produksi baja</b>: Magnesium berfungsi sebagai agen de-sulfurisasi dalam proses pembuatan baja, membantu menghilangkan sulfur dari besi cair.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 49, 
                text: "<b>4. Kesehatan</b>: Magnesium berperan penting dalam berbagai proses biokimia dan digunakan sebagai obat pencahar umum, serta antasida.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            },
            { 
                time: 56, 
                text: "<b>5. Penggunaan dalam makanan</b>: Magnesium juga dapat ditemukan dalam suplemen dan makanan, membantu dalam penyerapan vitamin dan mineral penting.",
                audio: "ElevenLabs_2025-08-03T03_43_04_Brian_pre_sp100_s50_sb75_se0_b_m2.mp3"
            }
        ];
        
        let currentSubtitleIndex = 0;
        let narrationStartTime = 0;
        let isNarrating = false;
        let narrationProgress = 0;
        const totalNarrationTime = 65; // Total time in seconds
        let narrationInterval;
        let mainAudio;
        
        // Deteksi perangkat Android
        const isAndroid = /Android/i.test(navigator.userAgent);
        
        // Volume control
        const volumeControl = document.getElementById('volume-control');
        volumeControl.addEventListener('input', function() {
            if (mainAudio) {
                mainAudio.volume = this.value;
            }
            if (isAndroid && androidAudio) {
                androidAudio.volume = this.value;
            }
        });
        
        // Preload and set up audio
        function setupAudio() {
            // Gunakan audio khusus untuk Android
            if (isAndroid) {
                mainAudio = androidAudio;
                mainAudio.volume = volumeControl.value;
            } else {
                mainAudio = new Audio();
                mainAudio.volume = volumeControl.value;
            }
            
            mainAudio.src = narrationScript[0].audio;
            mainAudio.preload = 'auto';
        }
        
        setupAudio();
        
        function startNarration() {
            if (isNarrating) return;
            
            isNarrating = true;
            narrationStartTime = Date.now();
            subtitleEl.style.display = 'block';
            subtitleEl.innerHTML = narrationScript[0].text;
            currentSubtitleIndex = 0;
            
            // Solusi khusus untuk Android
            if (isAndroid) {
                try {
                    const playPromise = mainAudio.play();
                    
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.error('Playback error:', error);
                            subtitleEl.innerHTML = "Error: Audio tidak dapat diputar. Ketuk layar untuk mencoba lagi.";
                            subtitleEl.style.display = 'block';
                            isNarrating = false;
                        });
                    }
                } catch (e) {
                    console.error('Android audio play exception:', e);
                    subtitleEl.innerHTML = "Error: Audio tidak dapat diputar. Ketuk layar untuk mencoba lagi.";
                    subtitleEl.style.display = 'block';
                    isNarrating = false;
                    return;
                }
            } else {
                // Untuk desktop
                mainAudio.play().catch(e => {
                    console.error("Failed to play audio:", e);
                    subtitleEl.innerHTML = "Error: Audio tidak dapat diputar. Klik tombol play untuk mencoba lagi.";
                    subtitleEl.style.display = 'block';
                    isNarrating = false;
                });
            }
            
            clearInterval(narrationInterval);
            narrationInterval = setInterval(updateNarration, 100);
        }
        
        function pauseNarration() {
            isNarrating = false;
            if (mainAudio) {
                mainAudio.pause();
            }
            clearInterval(narrationInterval);
        }
        
        function restartNarration() {
            clearInterval(narrationInterval);
            if (mainAudio) {
                mainAudio.pause();
                mainAudio.currentTime = 0;
            }
            
            currentSubtitleIndex = 0;
            narrationProgress = 0;
            progressBar.style.width = '0%';
            subtitleEl.innerHTML = narrationScript[0].text;
            startNarration();
        }
        
        function updateNarration() {
            if (!isNarrating) return;
            
            const elapsedTime = (Date.now() - narrationStartTime) / 1000;
            narrationProgress = elapsedTime;
            
            // Update progress bar
            const progressPercent = (narrationProgress / totalNarrationTime) * 100;
            progressBar.style.width = `${Math.min(100, progressPercent)}%`;
            
            // Update subtitle
            if (currentSubtitleIndex < narrationScript.length - 1 && 
                elapsedTime >= narrationScript[currentSubtitleIndex + 1].time) {
                currentSubtitleIndex++;
                subtitleEl.innerHTML = narrationScript[currentSubtitleIndex].text;
            }
            
            // End of narration
            if (elapsedTime >= totalNarrationTime) {
                clearInterval(narrationInterval);
                isNarrating = false;
                setTimeout(() => {
                    subtitleEl.style.display = 'none';
                }, 3000);
            }
        }
        
        // Audio controls
        document.getElementById('audioPlay').addEventListener('click', startNarration);
        document.getElementById('audioPause').addEventListener('click', pauseNarration);
        document.getElementById('audioRestart').addEventListener('click', restartNarration);
        
        // Tambahkan event listener untuk interaksi pengguna
        document.body.addEventListener('click', function() {
            // Untuk memastikan konteks audio aktif di Android
            if (isAndroid && mainAudio) {
                mainAudio.play().catch(e => console.log('Silent play attempt failed'));
                mainAudio.pause();
                mainAudio.currentTime = 0;
            }
        });
        
        // ================ RENDER LOOP ================
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            animateElectrons();
            
            // Rotate nucleus slowly
            nucleusGroup.rotation.y += 0.002;
            nucleusGroup.rotation.x += 0.001;
            
            // Rotate stars
            stars.rotation.y += 0.0003;
            stars.rotation.x += 0.0002;
            
            renderer.render(scene, camera);
        }
        
        // Handle window resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }
        
        window.addEventListener('resize', onWindowResize);
        
        // Touch controls for mobile
        let touchStartX = 0;
        let touchStartY = 0;
        
        container.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        
        container.addEventListener('touchmove', function(e) {
            if (!e.touches || e.touches.length === 0) return;
            
            const touchX = e.touches[0].clientX;
            const touchY = e.touches[0].clientY;
            
            const deltaX = touchX - touchStartX;
            const deltaY = touchY - touchStartY;
            
            camera.position.x -= deltaX * 0.01;
            camera.position.y += deltaY * 0.01;
            
            touchStartX = touchX;
            touchStartY = touchY;
            
            e.preventDefault();
        }, { passive: false });
        
        // Start animation
        animate();
    </script>
</body>
</html>
